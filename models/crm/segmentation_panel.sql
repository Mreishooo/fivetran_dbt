{{ config(
    materialized='table',
    labels = {'source': 'uploaded_file', 'refresh': 'never','connection':'none','type':'mart'},
)}}

{% set cols  = [
"q101_1","q101_2","q1000","q1001","q9003_1","q9003_2","q9003_3","q9003_4","q9003_5","q10021","q10022","q10023","q10024","q100241","q100242","q100243","q100244","q100240","q90031_1","q90031_2","q9004_1","q9004_2","q9005_1","q9005_2","q9006_1","q9006_2","q9006_3","q9006_4","q9006_5","q9006_6","q9006_7","q10051","q10052","q10053","q10054","q10055","q10056","q10057","q10058","q10059","q100510","q100511","q100512","q10061","q10062","q10063","q10064","q10065","q10066","q10067","q10068","q10069","q10071","q10072","q10073","q10074","q10075","q10076","q10077","q10078","q10079","q100710","q90000_1","q90000_2","q110091","q110092","q110093","q110094","q110095","q110096","q110097","q110098","q110099","q1100910","q10081","q10082","q10083","q10084","q10085","q10086","q10087","q10088","q10089","q100810","q100811","q100812","q100813","q100814","q100815","q100816","q100817","q100818","q100819","q100820","q100821","q100822","q100823","q100824","q100825","q100826","q10091","q10092","q10093","q10094","q10095","q10096","q10097","q10098","q10099","q100910","q100911","q100912","q100101","q100102","q100103","q100104","q100105","q100106","q9012_1","q9012_2","q9012_3","q9012_4","q9012_5","q9012_6","q9012_7","q6001_1","q6001_2","q6001_3","q6001_4","q6001_5","q6001_6","q6001_7","q6001_8","q6001_9","q6001_10","q6001_11","q6001_12","q6001_13","q6001_14","q6001_15","q6001_16","q6001_17","q6001_18","q6001_19","q6001_20","q6001_21","q6001_22","q6001_23","q6001_24","q6001_25","q6001_26","q6002_1","q6002_2","q6002_3","q6002_4","q6002_5","q6002_6","q6002_7","q6002_8","q6002_9","q6002_10","q6002_11","q6002_12","q6002_13","q6002_14","q6002_15","q6002_16","q6002_17","q6002_18","q6002_19","q6002_20","q6002_21","q6002_22","q6002_23","q6002_24","q6002_25","q6002_26","q6003","q6004_1","q6004_2","q6004_3","q6004_4","q6004_5","q6004_6","q6004_7","q6004_8","q6004_9","q6004_10","q6004_11","q6004_12","q6004_13","q6004_14","q6004_15","q6004_16","q6004_17","q6004_18","q6004_19","q6004_20","q6004_21","q6004_22","q6004_23","q6004_24","q6004_25","q6004_26","q3000","q90002_1","q90002_2","q30021_1","q30021_2","q30021_3","q30021_4","q30021_5","q30021_6","q30021_7","q30021_8","q30021_9","q30021_10","q30021_11","q30021_12","q30021_13","q30021_14","q30021_15","q30021_16","q30021_17","q30022_1","q30022_2","q30022_3","q30022_4","q30022_5","q30022_6","q30022_7","q30022_8","q30022_9","q30023","q3007_1","q3007_2","q3007_3","q3007_4","q3007_5","q3007_6","q30071_1","q30071_2","q30071_3","q30071_4","q30072_1","q30072_2","q30072_3","q30072_4","q30072_5","q30072_6","q30072_7","q30072_8","q30073_1","q30073_2","q30073_3","q30073_4","q30073_5","q30073_6","q30073_7","q30074_1","q30074_2","q30074_3","q30074_4","q30075_1","q30075_2","q30075_3","q30031_1","q30031_2","q30031_3","q30031_4","q30031_5","q30031_6","q30031_7","q30031_8","q30031_9","q30031_10","q30032_1","q30032_2","q30032_3","q30032_4","q30032_5","q30032_6","q30032_7","q30032_8","q30032_9","q30032_10","q3004","q3005","q3008_1","q3008_2","q3008_3","q3008_4","q3008_5","q3008_6","q3008_7","q3008_8","q3008_9","q3008_10","q3008_11","q3008_12","q3008_13","q30081_1","q30081_2","q30081_3","q30081_4","q30081_5","q30082_1","q30082_2","q30082_3","q30082_4","q30082_5","q30083_1","q30083_2","q30083_3","q30083_4","q30084_1","q30084_2","q30084_3","q30084_4","q30084_5","q30084_6","q30085_1","q30085_2","q30085_3","q30085_4","q3006_1","q3006_2","q3006_3","q3006_4","q3006_5","q3006_6","q3006_7","q3006_8","q3006_9","q3006_10","q30061_1","q30061_2","q30061_3","q30061_4","q30061_5","q30061_6","q30062_1","q30062_2","q30063_1","q30063_2","q30063_3","q30063_4","q30063_5","q30063_6","q30064_1","q30064_2","q30064_3","q30064_4","q30064_5","q30064_6","q30065_1","q30065_2","q30065_3","q30066_1","q30066_2","q30066_3","q30066_4","q30066_5","q30066_6","q30066_7","q30066_8","q30066_9","q4001_1","q4001_2","q4001_3","q4001_4","q4001_5","q4001_6","q4001_7","q4001_8","q4001_9","q4001_10","q4001_11","q4001_12","q4001_13","q4001_14","q4001_15","q4001_16","q4001_17","q4001_18","q4001_19","q4001_20","q4001_21","q4001_22","q4001_23","q4001_24","q4001_25","q4001_26","q4003","q4004","q4002_1","q4002_2","q4002_3","q4002_4","q4002_5","q4002_6","q4002_7","q4002_8","q4002_9","q4002_10","q4002_11","q4002_12","q4002_13","q4002_14","q4005_1","q4005_2","q4005_3","q4005_4","q4005_5","q4005_6","q4005_7","q4005_8","q4005_9","q4005_10","q4005_11","q4005_12","q4005_13","q4005_14","q4005_15","q4005_16","q4005_17","q4005_18","q4005_19","q4005_20","q4005_21","q4005_22","q7001","q70011","q70012","q7003","q7004","q7006","q7007_1","q7007_2","q7007_3","q7007_4","q7007_5","q7007_6","q7007_7","q7007_8","q7007_9","q7007_10","q7007_11","q7007_12","q7008","q7009","q50021","q50022","q50023","q50024","q50025","q50026","q50027","q50028","q50029","q500210","q50031","q50032","q50033","q50034","q50035","q50036","q50037","q50038","q50039","q500310","q5004","q50051","q50052","q50053","q50054","q50055","q50056","q505_1","q50091","q50092","q50093","q50094","q50095","q500911_1","q500911_2","q500911_3","q500911_4","q500911_5","q500911_6","q500911_7","q500911_8","q500911_9","q500911_10","q500911_11","q500951_1","q500951_2","q500951_3","q500951_4","q500951_5","q500951_6","q500951_7","q500951_8","q500951_9","q500951_10","q500951_11","q50061","q50062","q50063","q50064","q50065","q50066","q50067","q50068","q50069","q500610","q500611","q500612","q500613","q500614","q500615","q500616","q500617","q150061_1","q150061_2","q150061_3","q150061_4","q150061_5","q150061_6","q150061_7","q150061_8","q150061_9","q150061_10","q150061_11","q150061_12","q150061_13","q150061_14","q150061_15","q150061_16","q150063_1","q150063_2","q150063_3","q150063_4","q150063_5","q150063_6","q150063_7","q150063_8","q150063_9","q150063_10","q150063_11","q150063_12","q150063_13","q150063_14","q150063_15","q60020_1","q60020_2","q60020_3","q60020_4","q60020_5","q60020_6","q60020_7","q60020_8","q60020_9","q60020_10","q60020_11","q60020_12","q150065_1","q150065_2","q150065_3","q150065_4","q150065_5","q150065_6","q150065_7","q150065_8","q150065_9","q150065_10","q150065_11","q150065_12","q150065_13","q150065_14","q150065_15","q150065_16","q150065_17","q1500652_1","q1500652_2","q1500652_3","q1500652_4","q1500652_5","q1500652_6","q1500652_7","q1500652_8","q1500652_9","q1500652_10","q1500652_11","q1500653_1","q1500653_2","q1500653_3","q1500653_4","q1500653_5","q1500653_6","q1500653_7","q1500653_8","q1500653_9","q1500653_10","q1500653_11","q1500653_12","q1500653_13","q1500653_14","q1500653_15","q1500653_16","q1500653_17","q1500653_18","q1500653_19","q1500611_1","q1500611_2","q1500611_3","q1500611_4","q1500611_5","q1500611_6","q1500611_7","q1500611_8","q1500611_9","q1500611_10","q1500611_11","q1500611_12","q1500611_13","q1500611_14","q1500611_15","q1500613_1","q1500613_2","q1500613_3","q1500613_4","q1500613_5","q1500613_6","q1500613_7","q1500613_8","q1500613_9","q1500613_10","q1500613_11","q1500613_12","q1500613_13","q1500613_14","q1500613_15","q8025","q8026","q8027_1","q8027_2","q8027_3","q8027_4","q10041","q10042","q10043","q10044","q8001","q8002","q6008","q60040","q60030_1","q60030_2","q60030_3","q60030_4","q60030_5","q60030_6","q60030_7","q60030_8","q60030_9","q60030_10","q60030_11","q60030_12","q60030_13","q60030_14","q50011","q50012","q50013","q50014","q50015","q50016","q50017","q50018","q50019","q500110","q3061","q3062","q3063","q3064","q3065","q3066","q3067","q3068","q3069","q3070","q3071","q9001_1","q9001_2","q9001_3","q9001_4","q10022_13c","q9013_1","q9013_2","q9013_3","q9013_4","q9013_5","q9013_6","q9013_7","q6003_26c","q30021_17c","q30022_9c","q3007_6c","q30031_10c","q30032_10c","q3008_13c","q3006_10c","q4001_26c","q4003_22c","q4004c","q4002_14c","q4005_22c","q7001_6c","q70011_9c","q70012_9c","q7003_6c","q7006_19c","q7007_12c","q500911_11c","q500951_11c","q150061_17","q150061_18","q150061_18c","q150063_15c","q60020_12c","q150065_17c","q1500611_15c","q1500613_15c","q60040_10c","q60030_14c","q994005c","q150061_16c","q150063_16","q150063_16c","q1500611_16","q1500611_16c","q1500613_16","q1500613_16c","q150065_15c"
] %}

with t1 as
(
  select user_id,country,survey_i,sample,
  {% for col in cols %}
    cast({{col}} as string) as {{col}},
  {% endfor %}
  FROM {{ source('upload', 'segmentation_panel') }}
) 


SELECT user_id, country,survey_i,  sample,question ,answer
FROM t1
 UNPIVOT(answer FOR question  IN (
q101_1,q101_2,q1000,q1001,q9003_1,q9003_2,q9003_3,q9003_4,q9003_5,q10021,q10022,q10023,q10024,q100241,q100242,q100243,q100244,q100240,q90031_1,q90031_2,q9004_1,q9004_2,q9005_1,q9005_2,q9006_1,q9006_2,q9006_3,q9006_4,q9006_5,q9006_6,q9006_7,q10051,q10052,q10053,q10054,q10055,q10056,q10057,q10058,q10059,q100510,q100511,q100512,q10061,q10062,q10063,q10064,q10065,q10066,q10067,q10068,q10069,q10071,q10072,q10073,q10074,q10075,q10076,q10077,q10078,q10079,q100710,q90000_1,q90000_2,q110091,q110092,q110093,q110094,q110095,q110096,q110097,q110098,q110099,q1100910,q10081,q10082,q10083,q10084,q10085,q10086,q10087,q10088,q10089,q100810,q100811,q100812,q100813,q100814,q100815,q100816,q100817,q100818,q100819,q100820,q100821,q100822,q100823,q100824,q100825,q100826,q10091,q10092,q10093,q10094,q10095,q10096,q10097,q10098,q10099,q100910,q100911,q100912,q100101,q100102,q100103,q100104,q100105,q100106,q9012_1,q9012_2,q9012_3,q9012_4,q9012_5,q9012_6,q9012_7,q6001_1,q6001_2,q6001_3,q6001_4,q6001_5,q6001_6,q6001_7,q6001_8,q6001_9,q6001_10,q6001_11,q6001_12,q6001_13,q6001_14,q6001_15,q6001_16,q6001_17,q6001_18,q6001_19,q6001_20,q6001_21,q6001_22,q6001_23,q6001_24,q6001_25,q6001_26,q6002_1,q6002_2,q6002_3,q6002_4,q6002_5,q6002_6,q6002_7,q6002_8,q6002_9,q6002_10,q6002_11,q6002_12,q6002_13,q6002_14,q6002_15,q6002_16,q6002_17,q6002_18,q6002_19,q6002_20,q6002_21,q6002_22,q6002_23,q6002_24,q6002_25,q6002_26,q6003,q6004_1,q6004_2,q6004_3,q6004_4,q6004_5,q6004_6,q6004_7,q6004_8,q6004_9,q6004_10,q6004_11,q6004_12,q6004_13,q6004_14,q6004_15,q6004_16,q6004_17,q6004_18,q6004_19,q6004_20,q6004_21,q6004_22,q6004_23,q6004_24,q6004_25,q6004_26,q3000,q90002_1,q90002_2,q30021_1,q30021_2,q30021_3,q30021_4,q30021_5,q30021_6,q30021_7,q30021_8,q30021_9,q30021_10,q30021_11,q30021_12,q30021_13,q30021_14,q30021_15,q30021_16,q30021_17,q30022_1,q30022_2,q30022_3,q30022_4,q30022_5,q30022_6,q30022_7,q30022_8,q30022_9,q30023,q3007_1,q3007_2,q3007_3,q3007_4,q3007_5,q3007_6,q30071_1,q30071_2,q30071_3,q30071_4,q30072_1,q30072_2,q30072_3,q30072_4,q30072_5,q30072_6,q30072_7,q30072_8,q30073_1,q30073_2,q30073_3,q30073_4,q30073_5,q30073_6,q30073_7,q30074_1,q30074_2,q30074_3,q30074_4,q30075_1,q30075_2,q30075_3,q30031_1,q30031_2,q30031_3,q30031_4,q30031_5,q30031_6,q30031_7,q30031_8,q30031_9,q30031_10,q30032_1,q30032_2,q30032_3,q30032_4,q30032_5,q30032_6,q30032_7,q30032_8,q30032_9,q30032_10,q3004,q3005,q3008_1,q3008_2,q3008_3,q3008_4,q3008_5,q3008_6,q3008_7,q3008_8,q3008_9,q3008_10,q3008_11,q3008_12,q3008_13,q30081_1,q30081_2,q30081_3,q30081_4,q30081_5,q30082_1,q30082_2,q30082_3,q30082_4,q30082_5,q30083_1,q30083_2,q30083_3,q30083_4,q30084_1,q30084_2,q30084_3,q30084_4,q30084_5,q30084_6,q30085_1,q30085_2,q30085_3,q30085_4,q3006_1,q3006_2,q3006_3,q3006_4,q3006_5,q3006_6,q3006_7,q3006_8,q3006_9,q3006_10,q30061_1,q30061_2,q30061_3,q30061_4,q30061_5,q30061_6,q30062_1,q30062_2,q30063_1,q30063_2,q30063_3,q30063_4,q30063_5,q30063_6,q30064_1,q30064_2,q30064_3,q30064_4,q30064_5,q30064_6,q30065_1,q30065_2,q30065_3,q30066_1,q30066_2,q30066_3,q30066_4,q30066_5,q30066_6,q30066_7,q30066_8,q30066_9,q4001_1,q4001_2,q4001_3,q4001_4,q4001_5,q4001_6,q4001_7,q4001_8,q4001_9,q4001_10,q4001_11,q4001_12,q4001_13,q4001_14,q4001_15,q4001_16,q4001_17,q4001_18,q4001_19,q4001_20,q4001_21,q4001_22,q4001_23,q4001_24,q4001_25,q4001_26,q4003,q4004,q4002_1,q4002_2,q4002_3,q4002_4,q4002_5,q4002_6,q4002_7,q4002_8,q4002_9,q4002_10,q4002_11,q4002_12,q4002_13,q4002_14,q4005_1,q4005_2,q4005_3,q4005_4,q4005_5,q4005_6,q4005_7,q4005_8,q4005_9,q4005_10,q4005_11,q4005_12,q4005_13,q4005_14,q4005_15,q4005_16,q4005_17,q4005_18,q4005_19,q4005_20,q4005_21,q4005_22,q7001,q70011,q70012,q7003,q7004,q7006,q7007_1,q7007_2,q7007_3,q7007_4,q7007_5,q7007_6,q7007_7,q7007_8,q7007_9,q7007_10,q7007_11,q7007_12,q7008,q7009,q50021,q50022,q50023,q50024,q50025,q50026,q50027,q50028,q50029,q500210,q50031,q50032,q50033,q50034,q50035,q50036,q50037,q50038,q50039,q500310,q5004,q50051,q50052,q50053,q50054,q50055,q50056,q505_1,q50091,q50092,q50093,q50094,q50095,q500911_1,q500911_2,q500911_3,q500911_4,q500911_5,q500911_6,q500911_7,q500911_8,q500911_9,q500911_10,q500911_11,q500951_1,q500951_2,q500951_3,q500951_4,q500951_5,q500951_6,q500951_7,q500951_8,q500951_9,q500951_10,q500951_11,q50061,q50062,q50063,q50064,q50065,q50066,q50067,q50068,q50069,q500610,q500611,q500612,q500613,q500614,q500615,q500616,q500617,q150061_1,q150061_2,q150061_3,q150061_4,q150061_5,q150061_6,q150061_7,q150061_8,q150061_9,q150061_10,q150061_11,q150061_12,q150061_13,q150061_14,q150061_15,q150061_16,q150063_1,q150063_2,q150063_3,q150063_4,q150063_5,q150063_6,q150063_7,q150063_8,q150063_9,q150063_10,q150063_11,q150063_12,q150063_13,q150063_14,q150063_15,q60020_1,q60020_2,q60020_3,q60020_4,q60020_5,q60020_6,q60020_7,q60020_8,q60020_9,q60020_10,q60020_11,q60020_12,q150065_1,q150065_2,q150065_3,q150065_4,q150065_5,q150065_6,q150065_7,q150065_8,q150065_9,q150065_10,q150065_11,q150065_12,q150065_13,q150065_14,q150065_15,q150065_16,q150065_17,q1500652_1,q1500652_2,q1500652_3,q1500652_4,q1500652_5,q1500652_6,q1500652_7,q1500652_8,q1500652_9,q1500652_10,q1500652_11,q1500653_1,q1500653_2,q1500653_3,q1500653_4,q1500653_5,q1500653_6,q1500653_7,q1500653_8,q1500653_9,q1500653_10,q1500653_11,q1500653_12,q1500653_13,q1500653_14,q1500653_15,q1500653_16,q1500653_17,q1500653_18,q1500653_19,q1500611_1,q1500611_2,q1500611_3,q1500611_4,q1500611_5,q1500611_6,q1500611_7,q1500611_8,q1500611_9,q1500611_10,q1500611_11,q1500611_12,q1500611_13,q1500611_14,q1500611_15,q1500613_1,q1500613_2,q1500613_3,q1500613_4,q1500613_5,q1500613_6,q1500613_7,q1500613_8,q1500613_9,q1500613_10,q1500613_11,q1500613_12,q1500613_13,q1500613_14,q1500613_15,q8025,q8026,q8027_1,q8027_2,q8027_3,q8027_4,q10041,q10042,q10043,q10044,q8001,q8002,q6008,q60040,q60030_1,q60030_2,q60030_3,q60030_4,q60030_5,q60030_6,q60030_7,q60030_8,q60030_9,q60030_10,q60030_11,q60030_12,q60030_13,q60030_14,q50011,q50012,q50013,q50014,q50015,q50016,q50017,q50018,q50019,q500110,q3061,q3062,q3063,q3064,q3065,q3066,q3067,q3068,q3069,q3070,q3071,q9001_1,q9001_2,q9001_3,q9001_4,q10022_13c,q9013_1,q9013_2,q9013_3,q9013_4,q9013_5,q9013_6,q9013_7,q6003_26c,q30021_17c,q30022_9c,q3007_6c,q30031_10c,q30032_10c,q3008_13c,q3006_10c,q4001_26c,q4003_22c,q4004c,q4002_14c,q4005_22c,q7001_6c,q70011_9c,q70012_9c,q7003_6c,q7006_19c,q7007_12c,q500911_11c,q500951_11c,q150061_17,q150061_18,q150061_18c,q150063_15c,q60020_12c,q150065_17c,q1500611_15c,q1500613_15c,q60040_10c,q60030_14c,q994005c,q150061_16c,q150063_16,q150063_16c,q1500611_16,q1500611_16c,q1500613_16,q1500613_16c,q150065_15c
))


